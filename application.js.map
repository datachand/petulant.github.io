{"version":3,"sources":["application.js"],"names":["Offline","Messenger","updateServerData","senddata","xhr","localStorage","setItem","JSON","stringify","updateLocalData","getLocalData","data","parse","getItem","keys","Object","$","each","i","v","val","syncmessenger","msg","post","message","hideAfter","actions","info","label","action","console","log","sync","hideAll","cancel","networkStatus","document","ready","hide","options","extraClasses","theme","window","applicationCache","addEventListener","status","UPDATEREADY","swapCache","confirm","location","reload","state","html","input1","input2","input3","input4","input5","input6","input7","attr","removeAttr","on","id","this"],"mappings":"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","file":"application.js","sourcesContent":["(function (Offline, Messenger) {\r\n\r\n\tvar networkStatus = null;\r\n\r\n\t$(document).ready(function() {\r\n\r\n\t\t$('.sync-button').hide();\r\n\r\n\r\n\t\tMessenger.options = {\r\n\t\t\textraClasses: 'messenger-fixed messenger-on-bottom messenger-on-right',\r\n\t\t\ttheme: 'flat'\r\n\t\t};\r\n\r\n\t\tif (window.applicationCache) {\r\n\t\t\twindow.applicationCache.addEventListener('updateready', function() {\r\n\t\t\t\tif (window.applicationCache.status === window.applicationCache.UPDATEREADY) {\r\n\t\t\t\t\twindow.applicationCache.swapCache();\r\n\t\t\t\t\tif (confirm('A new version of this App is available. Load it now?')) {\r\n\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.info(\"Manifest up-to-date\");\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\r\n\t\t\twindow.applicationCache.addEventListener('noupdate', function() {\r\n\t\t\t\tconsole.log(\"App is up-to-date\");\r\n\t\t\t}, false);\r\n\t\t}\r\n\r\n\t\tnetworkStatus = Offline.state;\r\n\t\t$('.offline-status').html(networkStatus === \"up\" ? \"<span class='label label-success'>Online</span>\" : \"<span class='label label-danger'>Offline</span>\");\r\n\t\tif(localStorage.getItem('local-data') === null) {\r\n\t\t\tvar data = {\r\n\t\t\t\t\"sync\": false,\r\n\t\t\t\t\"data\": {\r\n\t\t\t\t\t\"input1\" : null,\r\n\t\t\t\t\t\"input2\" : null,\r\n\t\t\t\t\t\"input3\" : null,\r\n\t\t\t\t\t\"input4\" : null,\r\n\t\t\t\t\t\"input5\" : null,\r\n\t\t\t\t\t\"input6\" : null,\r\n\t\t\t\t\t\"input7\" : null\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tlocalStorage.setItem('local-data', JSON.stringify(data));\r\n\t\t} else {\r\n\t\t\tvar senddata = JSON.parse(localStorage.getItem('local-data'));\r\n\t\t\tif (senddata.sync) {\r\n\t\t\t\tsyncmessenger();\r\n\t\t\t} else {\r\n\r\n\t\t\t\t$('.sync-button').hide();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(localStorage.getItem('offline-status') === null) {\r\n\t\t\tvar status = Offline.state;\r\n\t\t\tlocalStorage.setItem('offline-status', status);\r\n\t\t} else {\r\n\t\t\tvar status = localStorage.getItem('offline-status');\r\n\r\n\t\t\tif(status === \"up\") {\r\n\t\t\t\t$('#offline-simulate-check').attr('checked', 'checked');\r\n\t\t\t} else {\r\n\t\t\t\t$('#offline-simulate-check').removeAttr('checked');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log(Offline.state);\r\n\r\n\r\n\t\tgetLocalData();\r\n\t});\r\n\r\n\r\n\t$(document).on('click', '.fuel-input', function () {\r\n\r\n\t\tvar id = $(this).data('value');\r\n\r\n\t\tconsole.log(id);\r\n\r\n\t\tvar senddata = JSON.parse(localStorage.getItem('local-data'));\r\n\r\n\t\tconsole.log(senddata.data);\r\n\r\n\t\tsenddata.data[id] = $('#' + id).val();\r\n\r\n\t\tif (Offline.state === \"up\") {\r\n\t\t\tsenddata.sync = false;\r\n\t\t\tconsole.log(\"Up => \" + id);\r\n\t\t\tupdateServerData(senddata);\r\n\t\t} else {\r\n\t\t\tsenddata.sync = true;\r\n\t\t\tconsole.log(\"Down => \" + id);\r\n\t\t\tupdateLocalData(senddata);\r\n\t\t}\r\n\r\n\r\n\r\n\t});\r\n\r\n\tOffline.on('confirmed-down', function () {\r\n\t\tconsole.info('Confirmed Down');\r\n\t\tnetworkStatus = Offline.state;\r\n\t\t$('.offline-status').html(\"<span class='label label-danger'>Offline</span>\");\r\n\t\t// $('.sync-button').hide();\r\n\t});\r\n\r\n\tOffline.on('confirmed-up', function () {\r\n\t\tconsole.info('Confirmed Up');\r\n\t\tnetworkStatus = Offline.state;\r\n\t\t$('.offline-status').html(\"<span class='label label-success'>Online</span>\");\r\n\t\t// Need to Sync\r\n\r\n\t\tvar senddata = JSON.parse(localStorage.getItem('local-data'));\r\n\r\n\t\tif(senddata.sync) {\r\n\t\t\t// sync message\r\n\t\t\t// $('.sync-button').show();\r\n\t\t\tsyncmessenger();\r\n\t\t\tconsole.log(\"Do you like to sync?\");\r\n\r\n\r\n\t\t}\r\n\t});\r\n\r\n\tfunction updateServerData (senddata) {\r\n\t\tvar xhr = true;\r\n\t\tif(xhr) {\r\n\t\t\tlocalStorage.setItem('local-data', JSON.stringify(senddata));\r\n\t\t}\r\n\t\treturn xhr;\r\n\t}\r\n\r\n\tfunction updateLocalData (senddata) {\r\n\t\tlocalStorage.setItem('local-data', JSON.stringify(senddata));\r\n\t}\r\n\r\n\tfunction getLocalData () {\r\n\t\tvar data = JSON.parse(localStorage.getItem('local-data'));\r\n\r\n\t\tvar keys = Object.keys(data.data);\r\n\r\n\t\t$.each(keys, function (i, v) {\r\n\t\t\t$('#' + v).val(data.data[v]);\r\n\t\t});\r\n\t}\r\n\r\n\t$(document).on('click', '.sync-button', function () {\r\n\t\tconsole.log(\"Syncing Local Data\");\r\n\t\tvar senddata = JSON.parse(localStorage.getItem('local-data'));\r\n\t\tsenddata.sync = false;\r\n\t\tupdateServerData(senddata);\r\n\t\t// $('.sync-button').hide();\r\n\t});\r\n\r\n\tfunction syncmessenger () {\r\n\t\tvar msg = Messenger().post({\r\n\t\t\tmessage: \"Do you like to sync?\",\r\n\t\t\thideAfter: 10000,\r\n\t\t\tactions: {\r\n\t\t\t\tinfo: {\r\n\t\t\t\t\tlabel: 'Sync Now',\r\n\t\t\t\t\taction: function() {\r\n\t\t\t\t\t\tconsole.log(\"Syncing Local Data\");\r\n\t\t\t\t\t\tvar senddata = JSON.parse(localStorage.getItem('local-data'));\r\n\t\t\t\t\t\tsenddata.sync = false;\r\n\t\t\t\t\t\tupdateServerData(senddata);\r\n\t\t\t\t\t\t// $('.sync-button').hide();\r\n\t\t\t\t\t\tMessenger().hideAll();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcancel: {\r\n\t\t\t\t\taction: function() {\r\n\t\t\t\t\t\treturn msg.cancel();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t$(document).on('click', '#offline-simulate-check', function () {\r\n\t\tvar status = Offline.state;\r\n\t\tlocalStorage.setItem('offline-status', status);\r\n\t});\r\n\r\n})(window.Offline, window.Messenger);"],"sourceRoot":"/source/"}